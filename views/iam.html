{% extends "layout.html" %}

{% block content %}
<style>

td, th {
    padding: 5px 10px;
}
th {
    text-align:center;
}

td {
    text-align: right;
}

table {
    border-collapse: collapse;
    margin: 20px;
}

table, th, td {
    border: 1px solid black;
}

.iam_table_scroll_control {

   max-height:calc(100vh - 280px);
   overflow-y:visible;
   overflow-x:hidden;
}
</style>

<div class="card col-12 col-lg-10 col-8 phub-dialog">
  <div class="card-header">
    <h1>User Management
      <button type="button" class="close" 
        aria-label="Close" onclick='window.location.href="index.php";'>
        <svg width='18' height='18' style='stroke:black;'><use xlink:href='public/img/SVG2/sprite.svg#el-x'></use></svg>
      </button>
    </h1>   
  </div>

  <div class="card-body">

    <div class="card">
      <pre style="margin:20px; font-size: 16px">{{ stats }}</pre>
    </div>

    <div style='margin:20px;'>
        <div style='display: inline-block'>
          <svg style='stroke-width:0; fill: red' width='24' height='24'><use xlink:href='public/img/SVG2/sprite.svg#cross'></use></svg>
           delete a user
          <br>
          <svg style='stroke-width:0; fill: green' width='24' height='24'><use xlink:href='public/img/SVG2/sprite.svg#checked'></use></svg>
           toogle admin rights
        </div>
        <div style='/*display: inline-block; */ float:right'>
            <a href='#' class='white_list' style='float:right; font-size: larger' >Mail White list</a>
            <br>
    <!--
            <button class='btn btn-default invite_external_user' style='float:right' >Invite external user</button>
    -->
        </div>
    </div>


    <div class = "iam_table_scroll_control" >
        <table style="margin: 0 auto">
            <thead>
                <tr>
                <th></th>
                <th>Admin</th>
                <th>Mail</th>
                <!--<th>ID</th>-->
                <th>Safes<br>total</th>
                <th>Safes<br>shared</th>
                <th id='th_seen'>Seen</th>
                </tr>
            </thead>
            <tbody  id='userTableBody'>
            </tbody>
        </table>
    </div>
  </div>
</div>

<div class="modal" id="deleteUserModal" tabindex="-1" role="dialog" aria-labelledby="deleteUserLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="deleteUserLabel">Delete User</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        </div>
        <div class="modal-body">    
        Mail: <span id="user_mail"></span><br>
        ID: <span id="user_id"></span>
        </p>
        <div class="alert alert-danger" role="alert" id="delete_user_alert" ></div>
        <p id="delete_user_warning"> Are you sure?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="deleteUserCancelBtn" data-dismiss="modal">Cancel</button>
        <button  type="button" class="btn btn-primary "  id="deleteUserBtn">Delete</button>
      </div>
    </div>
  </div>
</div>

<style>
  
  .white_list_cancel {
    color:red; 
    border: none; 
    background: none;
  }

  #newUserMail, #newUserMail:focus  {
    flex:1; 
  /*  padding-left: 15px; */
  }

  .white_list_item {
    padding: 10px 0 10px 10px;
  }

  .white_list_item:hover {
    background: #eee;
  }

  .white_list_item > .glyphicon-remove {
    color:red;
    opacity: 0.2; 
    padding: 0 5px;
  }

  .white_list_item:hover > .glyphicon-remove {
    opacity: 1.0;
    cursor: pointer;
  }

</style>

<div class="modal" id="mailWhiteList" tabindex="-1" role="dialog" aria-labelledby="inviteByMailLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="mailWhiteListLabel">Mail white list</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body" style="font-size: 16px; padding-left: 30px; padding-right: 30px">
        <div class="form-group" style="display:flex">
          <input type="email" class="form-control" name="newUserMail" maxlength=254
          id="newUserMail" placeholder="New user mail" required >
          <button  type="button" class="btn btn-primary "  id="id_SubmitNewUserMail" style='margin: 0 0 0 10px' >Add</button>
          <button class="white_list_cancel" type="button" >Cancel</button>
        </div>
        <div class="alert alert-danger" role="alert" id="inviteByMailAlert" 
          style="display: none; margin-top: 20px; text-align: left;">
        </div>
        <div id='white_list_ul'>
        </div>
      </div>  
    </div>
  </div>
</div>  
<div id="csrf" data-csrf='{{ verifier }}' style='display:none'>
</div>
<a id="mailhref"></a>

{{include ('modals/idle_and_removal.html')}}

<script>
var page_args = {
    users: JSON.parse('{{ users | raw }}'),
    me: "{{ me }}"
}
</script>

<script src = "public/js/dist/iam.js?v=191212"></script> 

</div>
</div>

{% endblock %}
